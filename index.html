<!doctype html>
<html lang="ar" dir="rtl" data-theme="auto">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>لوحة المزود | تدريبي</title>
<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700;800;900&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box}
:root{--brand:#0a66b2;--brand-700:#084a85;--bg:#f5f8fc;--card:#ffffff;--line:#e6eef6;--text:#0d1b2a;--muted:#5d6f82;--shadow:0 12px 40px rgba(10,102,178,.12)}
@media(prefers-color-scheme:dark){:root{--bg:#0c1520;--card:#111c29;--line:#152235;--text:#e8eef6;--muted:#9fb0c3;--shadow:0 12px 40px rgba(0,0,0,.5)}}
html[data-mode="dark"]{--bg:#0c1520;--card:#111c29;--line:#152235;--text:#e8eef6;--muted:#9fb0c3;--shadow:0 12px 40px rgba(0,0,0,.5)}
html[data-mode="light"]{--bg:#f5f8fc;--card:#ffffff;--line:#e6eef6;--text:#0d1b2a;--muted:#5d6f82;--shadow:0 12px 40px rgba(10,102,178,.12)}
body{margin:0;background:var(--bg);color:var(--text);font-family:"Tajawal",system-ui,Arial}
.layout{display:grid;grid-template-columns:240px 1fr;min-height:100vh}
.sidebar{background:var(--card);border-left:1px solid var(--line);position:sticky;top:0;height:100vh;padding:14px 12px;overflow:auto;z-index:60}
.brand{display:flex;align-items:center;gap:10px;padding:6px 8px;margin-bottom:8px;text-decoration:none;color:inherit}
.brand .logo{width:40px;height:40px;border-radius:12px;background:linear-gradient(135deg,var(--brand),#46a1ff);display:grid;place-items:center;color:#fff;font-weight:900}
.brand .t{font-weight:900;color:var(--brand);font-size:18px}
.menu{display:flex;flex-direction:column;gap:6px}
.link{display:flex;align-items:center;gap:10px;padding:10px;border-radius:10px;color:inherit;text-decoration:none}
.link:hover,.link.active{background:rgba(10,102,178,.08)}
.badge{margin-right:auto;background:rgba(10,102,178,.12);color:var(--brand);border-radius:999px;padding:2px 8px;font-size:12px}
.topbar{position:sticky;top:0;z-index:70;background:rgba(255,255,255,.8);backdrop-filter:saturate(180%) blur(8px);border-bottom:1px solid var(--line);display:flex;align-items:center;justify-content:space-between;padding:10px 14px}
@media(prefers-color-scheme:dark){.topbar{background:rgba(17,28,41,.65)}}
.topbar .right{display:flex;align-items:center;gap:8px}
.btn{display:inline-flex;align-items:center;gap:8px;background:var(--brand);color:#fff;border:0;border-radius:12px;padding:9px 14px;font-weight:800;cursor:pointer;text-decoration:none}
.btn.ghost{background:transparent;color:var(--brand);border:1px solid var(--line)}
.container{padding:16px;max-width:1320px;margin:0 auto}
.grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
.card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:14px;box-shadow:var(--shadow)}
.card h3{margin:0 0 8px;font-size:15px;color:var(--muted)}
.kpi{display:flex;align-items:baseline;gap:6px}
.kpi .n{font-size:26px;font-weight:900;color:var(--brand)}
.cols-2{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px}
.table{width:100%;border-collapse:separate;border-spacing:0 8px}
.table th,.table td{padding:10px;background:var(--card);border:1px solid var(--line)}
.table th{color:var(--muted);font-weight:700}
.table td:first-child,.table th:first-child{border-radius:8px 0 0 8px}
.table td:last-child,.table th:last-child{border-radius:0 8px 8px 0}
.small{font-size:12px;color:var(--muted)}
.flex{display:flex;gap:8px;align-items:center}
.mode{border:1px solid var(--line);background:var(--card);color:var(--text);padding:8px 12px;border-radius:10px;cursor:pointer}
.burger{display:none;border:1px solid var(--line);background:var(--card);color:var(--text);padding:8px 12px;border-radius:10px;cursor:pointer}
.backdrop{position:fixed;inset:0;background:rgba(0,0,0,.35);backdrop-filter:blur(2px);z-index:50;opacity:0;visibility:hidden;transition:.25s}
.backdrop.show{opacity:1;visibility:visible}
.toast{position:fixed;top:16px;left:50%;transform:translateX(-50%);background:rgba(10,102,178,.08);color:var(--text);border:1px solid #9ad0ff;border-radius:12px;padding:10px 14px;z-index:90;opacity:0;pointer-events:none;transition:.25s}
.toast.show{opacity:1}
@media(max-width:1200px){.grid{grid-template-columns:1fr 1fr}.cols-2{grid-template-columns:1fr}}
@media(max-width:980px){.layout{grid-template-columns:1fr}.sidebar{position:fixed;inset:0 0 0 auto;width:min(280px,86vw);transform:translateX(100%);transition:transform .25s ease, box-shadow .25s;box-shadow:var(--shadow)}.sidebar.open{transform:translateX(0)}.burger{display:inline-block}}
@media(max-width:720px){.grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="layout">
<aside class="sidebar" id="sidebar">
  <a class="brand" href="index.html"><div class="logo">ت</div><div class="t">تدريبي</div></a>
  <nav class="menu">
    <a class="link active" href="index.html">لوحة المزود</a>
    <a class="link" href="provider_listings.html" data-open="listings">فرصي التدريبية</a>
    <a class="link" href="provider_applications.html" data-open="applications">طلبات المتقدمين</a>
    <a class="link" href="provider_settings.html" data-open="settings">إعدادات الحساب</a>
    <a class="link" href="login.html" data-open="logout">خروج</a>
  </nav>
</aside>
<div id="backdrop" class="backdrop"></div>
<main>
  <header class="topbar">
    <div class="right">
      <button id="burger" class="burger" type="button" aria-label="القائمة">☰</button>
      <strong id="hello"></strong>
      <span class="small" id="roleTag"></span>
    </div>
    <div class="right">
      <button id="mode" class="mode" type="button">الوضع: تلقائي</button>
      <a class="btn ghost" href="#">الصفحة الرئيسية</a>
      <a class="btn" href="#">خروج</a>
    </div>
  </header>
  <div class="container">
    <div class="grid">
      <div class="card"><h3>قوائمك</h3><div class="kpi"><div class="n" id="k_listings">0</div><div class="small">إجمالي الفرص</div></div></div>
      <div class="card"><h3>الطلبات</h3><div class="kpi"><div class="n" id="k_apps_total">0</div><div class="small">إجمالي</div></div></div>
      <div class="card"><h3>قيد المراجعة</h3><div class="kpi"><div class="n" id="k_apps_pending">0</div></div></div>
      <div class="card"><h3>مقبول / مرفوض</h3><div class="kpi"><div class="n" id="k_apps_ok">0 / 0</div></div></div>
    </div>
    <div class="cols-2" style="margin-top:12px">
      <div class="card">
        <h3>أحدث الطلبات</h3>
        <table class="table" id="appsTable">
          <thead><tr><th>المتقدم</th><th>البريد</th><th>الفرصة</th><th>الحالة</th><th>التاريخ</th><th>إجراء</th></tr></thead>
          <tbody></tbody>
        </table>
        <div class="small">المزيد في صفحة الطلبات</div>
      </div>
      <div class="card">
        <h3>إنشاء/إدارة فرص التدريب</h3>
        <div class="small">يمكنك إضافة فرص جديدة أو تعديل الموجودة.</div>
        <div class="flex" style="margin-top:8px">
          <a class="btn" href="#" id="manageListings">إدارة الفرص</a>
          <a class="btn ghost" href="#" id="createListing">+ فرصة جديدة</a>
        </div>
        <hr style="border:0;border-top:1px solid var(--line);margin:14px 0">
        <h3>إرسال إشعار عام لمتقدميك</h3>
        <form id="announceForm">
          <textarea id="announceMsg" placeholder="رسالتك ستصل لكل من تقدّم لفرصك" required style="width:100%;min-height:90px;border:1px solid var(--line);border-radius:12px;background:transparent;color:var(--text);padding:10px"></textarea>
          <div class="flex" style="justify-content:flex-end;margin-top:8px">
            <button class="btn" type="submit">إرسال</button>
          </div>
        </form>
      </div>
    </div>
    <div class="card" style="margin-top:12px">
      <h3>أحدث الفرص</h3>
      <table class="table" id="listingsTable">
        <thead><tr><th>العنوان</th><th>الموقع</th><th>المدة</th><th>الموعد النهائي</th><th>التسجيل</th><th>إجراءات</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</main>
</div>
<div class="toast" id="toast"></div>
<script>
var uname=localStorage.getItem('tadribi_uname')||'مزود';
var role='provider';
var listings=JSON.parse(localStorage.getItem('tadribi_provider_listings')||'null')||[
  {id:101,title:'تدريب على التسويق الرقمي',location:'الرياض',duration:'3 أشهر',application_deadline:'2025-10-30',created_at:'2025-09-20 09:10:00'},
  {id:102,title:'برمجة بايثون لطلبة الجامعات',location:'جدة',duration:'6 أسابيع',application_deadline:'2025-10-15',created_at:'2025-09-18 14:22:00'},
  {id:103,title:'تحليل بيانات أولي',location:'الدمام',duration:'8 أسابيع',application_deadline:'2025-11-05',created_at:'2025-09-17 10:05:00'},
  {id:104,title:'تصميم تجربة المستخدم',location:'مكة',duration:'4 أسابيع',application_deadline:'2025-10-05',created_at:'2025-09-15 12:40:00'},
  {id:105,title:'إدارة المشاريع العملية',location:'أبها',duration:'10 أسابيع',application_deadline:'2025-11-20',created_at:'2025-09-12 08:33:00'}
];
var apps=JSON.parse(localStorage.getItem('tadribi_provider_apps')||'null')||[
  {id:1,uname:'أحمد صالح',uemail:'ahmed@gmail.com',ltitle:'تدريب على التسويق الرقمي',status:'pending',applied_at:'2025-09-21 13:11:00'},
  {id:2,uname:'جمانة خالد',uemail:'jumana@gmail.com',ltitle:'برمجة بايثون لطلبة الجامعات',status:'accepted',applied_at:'2025-09-21 11:09:00'},
  {id:3,uname:'وليد ناصر',uemail:'waleed@gmail.com',ltitle:'تحليل بيانات أولي',status:'rejected',applied_at:'2025-09-20 16:55:00'},
  {id:4,uname:'ريم محمد',uemail:'reem@gmail.com',ltitle:'تصميم تجربة المستخدم',status:'pending',applied_at:'2025-09-20 09:25:00'},
  {id:5,uname:'ليان فهد',uemail:'lian@gmail.com',ltitle:'إدارة المشاريع العملية',status:'pending',applied_at:'2025-09-19 18:47:00'},
  {id:6,uname:'طارق عادل',uemail:'tareq@gmail.com',ltitle:'برمجة بايثون لطلبة الجامعات',status:'pending',applied_at:'2025-09-19 08:10:00'}
];
function save(){localStorage.setItem('tadribi_provider_listings',JSON.stringify(listings));localStorage.setItem('tadribi_provider_apps',JSON.stringify(apps))}
function toast(msg){var t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');setTimeout(function(){t.classList.remove('show')},2000)}
function renderKPIs(){var total=listings.length;var totalApps=apps.length;var pending=apps.filter(function(a){return a.status==='pending'}).length;var accepted=apps.filter(function(a){return a.status==='accepted'}).length;var rejected=apps.filter(function(a){return a.status==='rejected'}).length;document.getElementById('k_listings').textContent=total;document.getElementById('k_apps_total').textContent=totalApps;document.getElementById('k_apps_pending').textContent=pending;document.getElementById('k_apps_ok').textContent=accepted+' / '+rejected}
function renderApps(){var tb=document.querySelector('#appsTable tbody');tb.innerHTML='';if(!apps.length){var tr=document.createElement('tr');var td=document.createElement('td');td.colSpan=6;td.className='small';td.textContent='لا توجد بيانات';tr.appendChild(td);tb.appendChild(tr);return}apps.slice(0,10).forEach(function(a){var tr=document.createElement('tr');tr.innerHTML='<td>'+a.uname+'</td><td>'+a.uemail+'</td><td>'+a.ltitle+'</td><td data-aid="'+a.id+'" class="app-status">'+a.status+'</td><td class="small">'+a.applied_at+'</td><td class="flex"><button class="btn" data-act="accept" data-id="'+a.id+'" style="padding:6px 10px">قبول</button><button class="btn ghost" data-act="reject" data-id="'+a.id+'" style="padding:6px 10px">رفض</button></td>';
  tb.appendChild(tr)})}
function renderListings(){var tb=document.querySelector('#listingsTable tbody');tb.innerHTML='';if(!listings.length){var tr=document.createElement('tr');var td=document.createElement('td');td.colSpan=6;td.className='small';td.textContent='لا توجد بيانات';tr.appendChild(td);tb.appendChild(tr);return}listings.slice().sort(function(a,b){return new Date(b.created_at)-new Date(a.created_at)}).slice(0,8).forEach(function(l){var tr=document.createElement('tr');tr.innerHTML='<td>'+l.title+'</td><td>'+l.location+'</td><td>'+l.duration+'</td><td class="small">'+(l.application_deadline||'—')+'</td><td class="small">'+l.created_at+'</td><td><a href="#" class="btn ghost" data-edit="'+l.id+'" style="padding:6px 10px">تعديل</a></td>';
  tb.appendChild(tr)})}
function renderAll(){renderKPIs();renderApps();renderListings()}
function updateStatus(id,st){var found=apps.find(function(x){return x.id==id});if(!found)return;if(['pending','accepted','rejected'].indexOf(st)===-1)return;found.status=st;save();renderAll();toast('تم تحديث حالة الطلب')}
function createListingFlow(){var t=prompt('عنوان الفرصة');if(!t)return;var loc=prompt('الموقع');if(!loc)return;var dur=prompt('المدة');if(!dur)return;var dl=prompt('الموعد النهائي (YYYY-MM-DD)')||'';var now=new Date();var id=Math.max(0].concat(listings.map(function(i){return i.id})).reduce(function(a,b){return Math.max(a,b)},100)+1;listings.push({id:id,title:t,location:loc,duration:dur,application_deadline:dl,created_at:now.getFullYear()+'-'+String(now.getMonth()+1).padStart(2,'0')+'-'+String(now.getDate()).padStart(2,'0')+' '+String(now.getHours()).padStart(2,'0')+':'+String(now.getMinutes()).padStart(2,'0')+':'+String(now.getSeconds()).padStart(2,'0')});save();renderAll();toast('تمت إضافة الفرصة')}
function editListing(id){var l=listings.find(function(x){return x.id==id});if(!l)return;var t=prompt('تعديل العنوان',l.title);if(!t)return;var loc=prompt('تعديل الموقع',l.location);if(!loc)return;var dur=prompt('تعديل المدة',l.duration);if(!dur)return;var dl=prompt('تعديل الموعد النهائي (YYYY-MM-DD)',l.application_deadline||'')||'';l.title=t;l.location=loc;l.duration=dur;l.application_deadline=dl;save();renderAll();toast('تم تعديل الفرصة')}
function announce(msg){if(!msg.trim())return;toast('تم إرسال الإشعار لجميع المتقدمين على فرصك');document.getElementById('announceMsg').value=''}
function initMode(){var mb=document.getElementById('mode');var m=localStorage.getItem('mode');if(m==='dark'){document.documentElement.setAttribute('data-mode','dark');mb.textContent='الوضع: ليلي'}else if(m==='light'){document.documentElement.setAttribute('data-mode','light');mb.textContent='الوضع: نهاري'}else{document.documentElement.removeAttribute('data-mode');mb.textContent='الوضع: تلقائي'}mb.addEventListener('click',function(){var html=document.documentElement,cur=html.getAttribute('data-mode');if(cur==='dark'){html.setAttribute('data-mode','light');localStorage.setItem('mode','light');this.textContent='الوضع: نهاري'}else if(cur==='light'){html.removeAttribute('data-mode');localStorage.removeItem('mode');this.textContent='الوضع: تلقائي'}else{html.setAttribute('data-mode','dark');localStorage.setItem('mode','dark');this.textContent='الوضع: ليلي'}})}
function initMenu(){var burger=document.getElementById('burger'),sidebar=document.getElementById('sidebar'),backdrop=document.getElementById('backdrop');function openMenu(){sidebar.classList.add('open');backdrop.classList.add('show');document.body.style.overflow='hidden'}function closeMenu(){sidebar.classList.remove('open');backdrop.classList.remove('show');document.body.style.overflow=''}if(burger)burger.addEventListener('click',openMenu);if(backdrop)backdrop.addEventListener('click',closeMenu);document.querySelectorAll('[data-open]').forEach(function(el){el.addEventListener('click',closeMenu)})}
function initEvents(){document.getElementById('appsTable').addEventListener('click',function(e){var act=e.target.getAttribute('data-act');if(!act)return;var id=parseInt(e.target.getAttribute('data-id'));if(act==='accept'){updateStatus(id,'accepted')}else if(act==='reject'){updateStatus(id,'rejected')}});document.getElementById('listingsTable').addEventListener('click',function(e){var id=e.target.getAttribute('data-edit');if(!id)return;e.preventDefault();editListing(parseInt(id))});document.getElementById('createListing').addEventListener('click',function(e){e.preventDefault();createListingFlow()});document.getElementById('manageListings').addEventListener('click',function(e){e.preventDefault();toast('افتح صفحة إدارة الفرص لاحقًا')});document.getElementById('announceForm').addEventListener('submit',function(e){e.preventDefault();announce(document.getElementById('announceMsg').value)})}
function boot(){document.getElementById('hello').textContent='مرحبًا، '+uname;document.getElementById('roleTag').textContent='دور: '+(role||'—');initMode();initMenu();renderAll();initEvents()}
boot()
</script>
</body>
</html>
